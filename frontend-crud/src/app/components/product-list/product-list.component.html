<div class="card fade-in-up">
  <!-- Barra de ferramentas aprimorada -->
  <p-toolbar styleClass="mb-4">
    <ng-template pTemplate="left">
      <div class="flex align-items-center gap-2">
        <i class="pi pi-box text-2xl text-primary"></i>
        <span class="text-xl font-semibold text-700">Lista de Produtos</span>
      </div>
    </ng-template>
    <ng-template pTemplate="right">
      <button
        pButton
        pRipple
        label="Novo Produto"
        icon="pi pi-plus"
        class="p-button-success"
        (click)="onNewProduct()"
      ></button>
    </ng-template>
  </p-toolbar>

  <!-- Barra de pesquisa global -->
  <div class="mb-4">
    <span class="p-input-icon-left w-full">
      <i class="pi pi-search"></i>
      <input 
        pInputText 
        type="text" 
        (input)="onGlobalFilter($event)" 
        placeholder="Pesquisar produtos..." 
        class="w-full"
        style="padding-left: 3rem;"
      />
    </span>
  </div>
  <!-- Tabela de Produtos aprimorada -->
  <p-table
    #dt
    [value]="products"
    dataKey="id"
    [rows]="10"
    [showCurrentPageReport]="true"
    [paginator]="true"
    [rowsPerPageOptions]="[5, 10, 20, 50]"
    currentPageReportTemplate="Exibindo {first} a {last} de {totalRecords} produtos"
    [globalFilterFields]="['name', 'price', 'available']"
    [loading]="loading"
    styleClass="p-datatable-gridlines"
    responsiveLayout="scroll"
  >
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="name" style="min-width: 200px;">
          <div class="flex align-items-center justify-content-between">
            <span>Nome do Produto</span>
            <div class="flex align-items-center gap-2">
              <p-sortIcon field="name"></p-sortIcon>
              <p-columnFilter type="text" field="name" display="menu"></p-columnFilter>
            </div>
          </div>
        </th>
        <th pSortableColumn="price" style="min-width: 150px;">
          <div class="flex align-items-center justify-content-between">
            <span>Preço</span>
            <div class="flex align-items-center gap-2">
              <p-sortIcon field="price"></p-sortIcon>
              <p-columnFilter type="numeric" field="price" display="menu"></p-columnFilter>
            </div>
          </div>
        </th>
        <th pSortableColumn="available" style="min-width: 150px;">
          <div class="flex align-items-center justify-content-center">
            <span>Status</span>
            <p-sortIcon field="available"></p-sortIcon>
          </div>
        </th>
        <th style="min-width: 200px;">
          <div class="text-center">
            <span>Ações</span>
          </div>
        </th>
      </tr>
    </ng-template>
    
    <ng-template pTemplate="body" let-product let-rowIndex="rowIndex">
      <tr class="fade-in-up" [style.animation-delay]="(rowIndex * 50) + 'ms'">
        <td>
          <div class="flex align-items-center gap-3">
            <div class="flex align-items-center justify-content-center bg-primary-100 text-primary-700 border-circle" 
                 style="width: 3rem; height: 3rem;">
              <i class="pi pi-box text-lg"></i>
            </div>
            <div>
              <div class="font-semibold text-900">{{ product.name }}</div>
              <div class="text-sm text-600">ID: {{ product.id }}</div>
            </div>
          </div>
        </td>
        <td>
          <div class="text-right">
            <div class="text-2xl font-bold text-900">
              {{ product.price | currency:'BRL':'symbol':'1.2-2' }}
            </div>
          </div>
        </td>
        <td>
          <div class="text-center">
            <span class="status-icon" 
                  [ngClass]="{
                    'status-available': product.available,
                    'status-unavailable': !product.available
                  }">
              <i class="pi" 
                 [ngClass]="{
                   'pi-check-circle': product.available,
                   'pi-times-circle': !product.available
                 }"></i>
            </span>
            <div class="text-sm mt-1" 
                 [ngClass]="{
                   'text-green-600': product.available,
                   'text-red-600': !product.available
                 }">
              {{ product.available ? 'Disponível' : 'Indisponível' }}
            </div>
          </div>
        </td>
        <td>
          <div class="flex justify-content-center gap-2">
            <button
              pButton
              pRipple
              icon="pi pi-eye"
              class="p-button-rounded p-button-info p-button-sm"
              (click)="onViewProduct(product)"
              pTooltip="Visualizar detalhes"
              tooltipPosition="top"
            ></button>
            <button
              pButton
              pRipple
              icon="pi pi-pencil"
              class="p-button-rounded p-button-success p-button-sm"
              (click)="onEditProduct(product)"
              pTooltip="Editar produto"
              tooltipPosition="top"
            ></button>
            <button
              pButton
              pRipple
              icon="pi pi-trash"
              class="p-button-rounded p-button-warning p-button-sm"
              (click)="onDeleteProduct(product)"
              pTooltip="Excluir produto"
              tooltipPosition="top"
            ></button>
          </div>
        </td>
      </tr>
    </ng-template>
    
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4">
          <div class="text-center py-6">
            <i class="pi pi-inbox text-6xl text-400 mb-3"></i>
            <div class="text-xl font-semibold text-600 mb-2">Nenhum produto encontrado</div>
            <div class="text-600">Que tal adicionar o primeiro produto?</div>
            <button
              pButton
              pRipple
              label="Adicionar Produto"
              icon="pi pi-plus"
              class="p-button-success mt-3"
              (click)="onNewProduct()"
            ></button>
          </div>
        </td>
      </tr>
    </ng-template>
    
    <ng-template pTemplate="loadingbody">
      <tr>
        <td colspan="4">
          <div class="text-center py-6">
            <p-progressSpinner [style]="{width: '50px', height: '50px'}"></p-progressSpinner>
            <div class="mt-3 text-600">Carregando produtos...</div>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
